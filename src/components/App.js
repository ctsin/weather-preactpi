import { h, Fragment } from 'preact'
import { useEffect, useState } from 'preact/hooks';

import Loader from './Loader';
import Title from './Title';

const App = () => {
  const [weather, setWeather] = useState({});

  useEffect(() => {
  //   fetch('/.netlify/functions/get-weather')
  //     .then(x => x.json())
  //     .then(res => console.log(res));
      setTimeout(() => {
        setWeather(JSON.parse('{"cod":"200","message":0,"cnt":40,"list":[{"dt":1585072800,"main":{"temp":4.67,"feels_like":-0.87,"temp_min":3.85,"temp_max":4.67,"pressure":1036,"sea_level":1036,"grnd_level":1029,"humidity":39,"temp_kf":0.82},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":3.77,"deg":105},"sys":{"pod":"n"},"dt_txt":"2020-03-24 18:00:00"},{"dt":1585083600,"main":{"temp":2.26,"feels_like":-3.65,"temp_min":1.65,"temp_max":2.26,"pressure":1037,"sea_level":1037,"grnd_level":1031,"humidity":46,"temp_kf":0.61},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":4.28,"deg":118},"sys":{"pod":"n"},"dt_txt":"2020-03-24 21:00:00"},{"dt":1585094400,"main":{"temp":0.82,"feels_like":-4.9,"temp_min":0.41,"temp_max":0.82,"pressure":1037,"sea_level":1037,"grnd_level":1030,"humidity":49,"temp_kf":0.41},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":3.96,"deg":117},"sys":{"pod":"n"},"dt_txt":"2020-03-25 00:00:00"},{"dt":1585105200,"main":{"temp":-0.44,"feels_like":-5.85,"temp_min":-0.64,"temp_max":-0.44,"pressure":1036,"sea_level":1036,"grnd_level":1029,"humidity":51,"temp_kf":0.2},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":3.43,"deg":110},"sys":{"pod":"n"},"dt_txt":"2020-03-25 03:00:00"},{"dt":1585116000,"main":{"temp":-0.55,"feels_like":-6.16,"temp_min":-0.55,"temp_max":-0.55,"pressure":1035,"sea_level":1035,"grnd_level":1029,"humidity":49,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":2},"wind":{"speed":3.66,"deg":100},"sys":{"pod":"d"},"dt_txt":"2020-03-25 06:00:00"},{"dt":1585126800,"main":{"temp":3.95,"feels_like":-2.47,"temp_min":3.95,"temp_max":3.95,"pressure":1035,"sea_level":1035,"grnd_level":1029,"humidity":32,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":4.68,"deg":111},"sys":{"pod":"d"},"dt_txt":"2020-03-25 09:00:00"},{"dt":1585137600,"main":{"temp":7.65,"feels_like":1.08,"temp_min":7.65,"temp_max":7.65,"pressure":1033,"sea_level":1033,"grnd_level":1027,"humidity":25,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":4.9,"deg":105},"sys":{"pod":"d"},"dt_txt":"2020-03-25 12:00:00"},{"dt":1585148400,"main":{"temp":8.05,"feels_like":1.42,"temp_min":8.05,"temp_max":8.05,"pressure":1031,"sea_level":1031,"grnd_level":1025,"humidity":29,"temp_kf":0},"weather":[{"id":803,"main":"Clouds","description":"broken clouds","icon":"04d"}],"clouds":{"all":57},"wind":{"speed":5.22,"deg":89},"sys":{"pod":"d"},"dt_txt":"2020-03-25 15:00:00"},{"dt":1585159200,"main":{"temp":4.88,"feels_like":-1.88,"temp_min":4.88,"temp_max":4.88,"pressure":1031,"sea_level":1031,"grnd_level":1025,"humidity":40,"temp_kf":0},"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03n"}],"clouds":{"all":29},"wind":{"speed":5.57,"deg":95},"sys":{"pod":"n"},"dt_txt":"2020-03-25 18:00:00"},{"dt":1585170000,"main":{"temp":3.06,"feels_like":-3.75,"temp_min":3.06,"temp_max":3.06,"pressure":1032,"sea_level":1032,"grnd_level":1025,"humidity":46,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":5.67,"deg":101},"sys":{"pod":"n"},"dt_txt":"2020-03-25 21:00:00"},{"dt":1585180800,"main":{"temp":1.4,"feels_like":-4.86,"temp_min":1.4,"temp_max":1.4,"pressure":1031,"sea_level":1031,"grnd_level":1024,"humidity":51,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":4.85,"deg":99},"sys":{"pod":"n"},"dt_txt":"2020-03-26 00:00:00"},{"dt":1585191600,"main":{"temp":0.16,"feels_like":-6.18,"temp_min":0.16,"temp_max":0.16,"pressure":1030,"sea_level":1030,"grnd_level":1023,"humidity":56,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":4.97,"deg":91},"sys":{"pod":"n"},"dt_txt":"2020-03-26 03:00:00"},{"dt":1585202400,"main":{"temp":0.15,"feels_like":-6.12,"temp_min":0.15,"temp_max":0.15,"pressure":1030,"sea_level":1030,"grnd_level":1023,"humidity":56,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":4.87,"deg":91},"sys":{"pod":"d"},"dt_txt":"2020-03-26 06:00:00"},{"dt":1585213200,"main":{"temp":5.03,"feels_like":-1.43,"temp_min":5.03,"temp_max":5.03,"pressure":1029,"sea_level":1029,"grnd_level":1023,"humidity":42,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":5.25,"deg":94},"sys":{"pod":"d"},"dt_txt":"2020-03-26 09:00:00"},{"dt":1585224000,"main":{"temp":8.73,"feels_like":2.08,"temp_min":8.73,"temp_max":8.73,"pressure":1028,"sea_level":1028,"grnd_level":1022,"humidity":36,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":5.7,"deg":90},"sys":{"pod":"d"},"dt_txt":"2020-03-26 12:00:00"},{"dt":1585234800,"main":{"temp":9.67,"feels_like":3.24,"temp_min":9.67,"temp_max":9.67,"pressure":1026,"sea_level":1026,"grnd_level":1020,"humidity":39,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":5.68,"deg":91},"sys":{"pod":"d"},"dt_txt":"2020-03-26 15:00:00"},{"dt":1585245600,"main":{"temp":6.95,"feels_like":1.39,"temp_min":6.95,"temp_max":6.95,"pressure":1026,"sea_level":1026,"grnd_level":1020,"humidity":52,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":2},"wind":{"speed":4.67,"deg":91},"sys":{"pod":"n"},"dt_txt":"2020-03-26 18:00:00"},{"dt":1585256400,"main":{"temp":5.58,"feels_like":0.02,"temp_min":5.58,"temp_max":5.58,"pressure":1026,"sea_level":1026,"grnd_level":1020,"humidity":59,"temp_kf":0},"weather":[{"id":803,"main":"Clouds","description":"broken clouds","icon":"04n"}],"clouds":{"all":71},"wind":{"speed":4.75,"deg":91},"sys":{"pod":"n"},"dt_txt":"2020-03-26 21:00:00"},{"dt":1585267200,"main":{"temp":4.91,"feels_like":-0.04,"temp_min":4.91,"temp_max":4.91,"pressure":1025,"sea_level":1025,"grnd_level":1019,"humidity":68,"temp_kf":0},"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04n"}],"clouds":{"all":86},"wind":{"speed":4.13,"deg":89},"sys":{"pod":"n"},"dt_txt":"2020-03-27 00:00:00"},{"dt":1585278000,"main":{"temp":4.15,"feels_like":-0.76,"temp_min":4.15,"temp_max":4.15,"pressure":1024,"sea_level":1024,"grnd_level":1018,"humidity":74,"temp_kf":0},"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04n"}],"clouds":{"all":100},"wind":{"speed":4.16,"deg":86},"sys":{"pod":"n"},"dt_txt":"2020-03-27 03:00:00"},{"dt":1585288800,"main":{"temp":4.09,"feels_like":-0.81,"temp_min":4.09,"temp_max":4.09,"pressure":1024,"sea_level":1024,"grnd_level":1017,"humidity":76,"temp_kf":0},"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04d"}],"clouds":{"all":100},"wind":{"speed":4.21,"deg":85},"sys":{"pod":"d"},"dt_txt":"2020-03-27 06:00:00"},{"dt":1585299600,"main":{"temp":8.13,"feels_like":3.72,"temp_min":8.13,"temp_max":8.13,"pressure":1023,"sea_level":1023,"grnd_level":1017,"humidity":63,"temp_kf":0},"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04d"}],"clouds":{"all":100},"wind":{"speed":3.8,"deg":83},"sys":{"pod":"d"},"dt_txt":"2020-03-27 09:00:00"},{"dt":1585310400,"main":{"temp":12.45,"feels_like":7.96,"temp_min":12.45,"temp_max":12.45,"pressure":1022,"sea_level":1022,"grnd_level":1016,"humidity":53,"temp_kf":0},"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04d"}],"clouds":{"all":97},"wind":{"speed":4.31,"deg":78},"sys":{"pod":"d"},"dt_txt":"2020-03-27 12:00:00"},{"dt":1585321200,"main":{"temp":12.75,"feels_like":8.35,"temp_min":12.75,"temp_max":12.75,"pressure":1020,"sea_level":1020,"grnd_level":1014,"humidity":53,"temp_kf":0},"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04d"}],"clouds":{"all":96},"wind":{"speed":4.24,"deg":85},"sys":{"pod":"d"},"dt_txt":"2020-03-27 15:00:00"},{"dt":1585332000,"main":{"temp":10.01,"feels_like":6.34,"temp_min":10.01,"temp_max":10.01,"pressure":1021,"sea_level":1021,"grnd_level":1015,"humidity":67,"temp_kf":0},"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04n"}],"clouds":{"all":98},"wind":{"speed":3.41,"deg":85},"sys":{"pod":"n"},"dt_txt":"2020-03-27 18:00:00"},{"dt":1585342800,"main":{"temp":8.11,"feels_like":4.95,"temp_min":8.11,"temp_max":8.11,"pressure":1021,"sea_level":1021,"grnd_level":1015,"humidity":73,"temp_kf":0},"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04n"}],"clouds":{"all":100},"wind":{"speed":2.52,"deg":91},"sys":{"pod":"n"},"dt_txt":"2020-03-27 21:00:00"},{"dt":1585353600,"main":{"temp":6.86,"feels_like":3.83,"temp_min":6.86,"temp_max":6.86,"pressure":1020,"sea_level":1020,"grnd_level":1014,"humidity":78,"temp_kf":0},"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04n"}],"clouds":{"all":98},"wind":{"speed":2.26,"deg":69},"sys":{"pod":"n"},"dt_txt":"2020-03-28 00:00:00"},{"dt":1585364400,"main":{"temp":5.8,"feels_like":2.96,"temp_min":5.8,"temp_max":5.8,"pressure":1019,"sea_level":1019,"grnd_level":1013,"humidity":83,"temp_kf":0},"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04n"}],"clouds":{"all":100},"wind":{"speed":1.95,"deg":67},"sys":{"pod":"n"},"dt_txt":"2020-03-28 03:00:00"},{"dt":1585375200,"main":{"temp":5.75,"feels_like":2.91,"temp_min":5.75,"temp_max":5.75,"pressure":1018,"sea_level":1018,"grnd_level":1012,"humidity":80,"temp_kf":0},"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04d"}],"clouds":{"all":98},"wind":{"speed":1.8,"deg":72},"sys":{"pod":"d"},"dt_txt":"2020-03-28 06:00:00"},{"dt":1585386000,"main":{"temp":10.25,"feels_like":7.9,"temp_min":10.25,"temp_max":10.25,"pressure":1017,"sea_level":1017,"grnd_level":1012,"humidity":60,"temp_kf":0},"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04d"}],"clouds":{"all":100},"wind":{"speed":1.17,"deg":89},"sys":{"pod":"d"},"dt_txt":"2020-03-28 09:00:00"},{"dt":1585396800,"main":{"temp":14.21,"feels_like":12.17,"temp_min":14.21,"temp_max":14.21,"pressure":1016,"sea_level":1016,"grnd_level":1011,"humidity":45,"temp_kf":0},"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04d"}],"clouds":{"all":100},"wind":{"speed":0.63,"deg":303},"sys":{"pod":"d"},"dt_txt":"2020-03-28 12:00:00"},{"dt":1585407600,"main":{"temp":14.61,"feels_like":11.86,"temp_min":14.61,"temp_max":14.61,"pressure":1014,"sea_level":1014,"grnd_level":1008,"humidity":44,"temp_kf":0},"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04d"}],"clouds":{"all":99},"wind":{"speed":1.65,"deg":312},"sys":{"pod":"d"},"dt_txt":"2020-03-28 15:00:00"},{"dt":1585418400,"main":{"temp":11.71,"feels_like":8.6,"temp_min":11.71,"temp_max":11.71,"pressure":1014,"sea_level":1014,"grnd_level":1008,"humidity":62,"temp_kf":0},"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04n"}],"clouds":{"all":99},"wind":{"speed":2.75,"deg":316},"sys":{"pod":"n"},"dt_txt":"2020-03-28 18:00:00"},{"dt":1585429200,"main":{"temp":8.31,"feels_like":4.66,"temp_min":8.31,"temp_max":8.31,"pressure":1015,"sea_level":1015,"grnd_level":1009,"humidity":80,"temp_kf":0},"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04n"}],"clouds":{"all":100},"wind":{"speed":3.63,"deg":341},"sys":{"pod":"n"},"dt_txt":"2020-03-28 21:00:00"},{"dt":1585440000,"main":{"temp":6.94,"feels_like":3.56,"temp_min":6.94,"temp_max":6.94,"pressure":1014,"sea_level":1014,"grnd_level":1008,"humidity":77,"temp_kf":0},"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04n"}],"clouds":{"all":100},"wind":{"speed":2.73,"deg":325},"sys":{"pod":"n"},"dt_txt":"2020-03-29 00:00:00"},{"dt":1585450800,"main":{"temp":5.62,"feels_like":1.35,"temp_min":5.62,"temp_max":5.62,"pressure":1013,"sea_level":1013,"grnd_level":1007,"humidity":69,"temp_kf":0},"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04n"}],"clouds":{"all":100},"wind":{"speed":3.35,"deg":322},"sys":{"pod":"n"},"dt_txt":"2020-03-29 03:00:00"},{"dt":1585461600,"main":{"temp":4.91,"feels_like":0.84,"temp_min":4.91,"temp_max":4.91,"pressure":1012,"sea_level":1012,"grnd_level":1007,"humidity":72,"temp_kf":0},"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04d"}],"clouds":{"all":100},"wind":{"speed":3.04,"deg":308},"sys":{"pod":"d"},"dt_txt":"2020-03-29 06:00:00"},{"dt":1585472400,"main":{"temp":7.25,"feels_like":3.34,"temp_min":7.25,"temp_max":7.25,"pressure":1012,"sea_level":1012,"grnd_level":1006,"humidity":61,"temp_kf":0},"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04d"}],"clouds":{"all":100},"wind":{"speed":2.8,"deg":329},"sys":{"pod":"d"},"dt_txt":"2020-03-29 09:00:00"},{"dt":1585483200,"main":{"temp":9.85,"feels_like":6.42,"temp_min":9.85,"temp_max":9.85,"pressure":1012,"sea_level":1012,"grnd_level":1006,"humidity":53,"temp_kf":0},"weather":[{"id":804,"main":"Clouds","description":"overcast clouds","icon":"04d"}],"clouds":{"all":100},"wind":{"speed":2.22,"deg":334},"sys":{"pod":"d"},"dt_txt":"2020-03-29 12:00:00"},{"dt":1585494000,"main":{"temp":7.28,"feels_like":2.84,"temp_min":7.28,"temp_max":7.28,"pressure":1012,"sea_level":1012,"grnd_level":1006,"humidity":81,"temp_kf":0},"weather":[{"id":500,"main":"Rain","description":"light rain","icon":"10d"}],"clouds":{"all":100},"wind":{"speed":4.52,"deg":15},"rain":{"3h":1.5},"sys":{"pod":"d"},"dt_txt":"2020-03-29 15:00:00"}],"city":{"id":2950159,"name":"Berlin","coord":{"lat":52.5244,"lon":13.4105},"country":"DE","population":1000000,"timezone":3600,"sunrise":1585025923,"sunset":1585070773}}'));
      }, 1000);
  }, []);

  return (
    <Fragment>
      {console.log(weather)}
      {weather.cod !== "200" ?
        <Loader />
        :
        <Fragment>
          <Title {...weather.city}></Title>
        </ Fragment>
      }
    </ Fragment>
  );
};

export default App;
